<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C 的 main 函数 | Yangholmes' blog</title>
    <meta name="description" content="blog">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/assets/style.CcAYowL6.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.DgOcM41a.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.C25bs69F.js">
    <link rel="modulepreload" href="/assets/chunks/framework.Czu1npcN.js">
    <link rel="modulepreload" href="/assets/派的玩耍小记_C 的 main 函数_index.md.CxFTzX28.lean.js">
    <link rel="icon" type="image/x-icon" href="/icon.png">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body><!--teleport start anchor--><div class="overlay" data-v-c4aa3776></div><!--teleport anchor-->
    <div id="app"><div class="main-layout" data-v-bbaec52f><div class="left-side" data-v-bbaec52f><div class="sidebar" data-v-bbaec52f data-v-c4aa3776><div class="mobile-only handler" data-v-c4aa3776 data-v-26c03762 data-v-8a8dc170><!--[--><div class="toggle-handler" data-v-26c03762><span class="vpi-chevron-right icon" data-v-26c03762></span></div><!--]--></div><div class="top-bar" data-v-c4aa3776><div class="theme-switch is-dark" data-v-c4aa3776 data-v-6427e52d><div class="round-button switch sun" data-v-6427e52d data-v-d3afb744><span class="vpi-sun icon" data-v-d3afb744></span></div><div class="round-button switch moon" data-v-6427e52d data-v-d3afb744><span class="vpi-moon icon" data-v-d3afb744></span></div></div><div class="VPNavBarSearch plugin search" data-v-c4aa3776 data-v-d17e8928><!----><div id="docsearch"><!--[--><div class="round-button" data-v-d17e8928 data-v-d3afb744><span class="vpi-search icon" data-v-d3afb744></span></div><!--]--></div></div></div><ul class="nav" data-v-c4aa3776><!--[--><li class="" data-v-c4aa3776><a href="/技术的小记/" data-v-c4aa3776>技术的小记</a></li><li class="active" data-v-c4aa3776><a href="/派的玩耍小记/" data-v-c4aa3776>派的玩耍小记</a></li><li class="" data-v-c4aa3776><a href="/生活咏叹调/" data-v-c4aa3776>生活咏叹调</a></li><!--]--></ul><div class="bottom-bar" data-v-c4aa3776><ul class="socials" data-v-c4aa3776 data-v-fb1a9594><!--[--><li data-v-fb1a9594><a href="https://github.com/Yangholmes" target="_blank" rel="noopener noreferrer" data-v-fb1a9594><div class="social-icon" style="--mask-image: "></div></a></li><li data-v-fb1a9594><a href="https://dev.to/yangholmes" target="_blank" rel="noopener noreferrer" data-v-fb1a9594><div class="social-icon" style="--mask-image: "></div></a></li><li data-v-fb1a9594><a href="https://www.instagram.com/yangholmes/" target="_blank" rel="noopener noreferrer" data-v-fb1a9594><div class="social-icon" style="--mask-image: "></div></a></li><li data-v-fb1a9594><a href="/wechat-qrcode.png" target="_blank" rel="noopener noreferrer" data-v-fb1a9594><div class="social-icon" style="--mask-image: "></div></a></li><!--]--></ul></div><!--teleport start--><!--teleport end--></div></div><main class="content" data-v-bbaec52f><div class="nav-bar" data-v-bbaec52f data-v-22de979f><div class="round-button" data-v-22de979f data-v-d3afb744><span class="vpi-arrow-left icon" data-v-d3afb744></span></div></div><div class="page" data-v-bbaec52f data-v-872e3c31><div class="vp-doc" data-v-872e3c31><div style="position:relative;" data-v-872e3c31><div><h3 id="linux-c-程序入口函数-main-小解" tabindex="-1">Linux C 程序入口函数 main() 小解 <a class="header-anchor" href="#linux-c-程序入口函数-main-小解" aria-label="Permalink to &quot;Linux C 程序入口函数 main() 小解&quot;">​</a></h3><p><strong>2019-10-27</strong></p><p>Linux 系统中，C 程序总是从 <code>main()</code> 函数开始的，当用户编写好的程序在运行的时候，操作系统慧使用 <code>exec()</code> 函数运行程序。在调用 <code>main()</code> 之前，<code>exec()</code> 系统调用会先调用一个特殊的启动例程，负责从操作系统内核读取程序的命令行参数，为 <code>main()</code> 函数准备好工作环境。</p><p><code>main()</code> 函数的定义为</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> envp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>参数 argc 表示 命令行参数的个数，即参数 argv 的长度，argv 是一个字符串数组指针，argv 的元素就是参数的内容。envp 是系统环境变量列表，存放了一组进程运行过程中会用到的环境变量。</p><p>ANSI 规定 <code>main()</code> 函数只有前两个参数，而 POSIX 则使用了一个全局的环境变量 environ 来取代 envp ，应用程序可以通过 <code>getenv()</code> 和 <code>putenv()</code> 函数来读取或者设置一个环境变量。</p><h4 id="系统如何执行-main-函数" tabindex="-1">系统如何执行 <code>main()</code> 函数 <a class="header-anchor" href="#系统如何执行-main-函数" aria-label="Permalink to &quot;系统如何执行 `main()` 函数&quot;">​</a></h4><p>用 strace 来分析 <code>main()</code> 的执行。我们先写一段测试用的程序：</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">#include</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;stdio.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argc</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> argv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">char*</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> envp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">[]</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> argc; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Argument </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, i, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">argv</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[i]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>接下来编译链接：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mian.c</span></span></code></pre></div><p>得到可执行文件 main ，然后运行它</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./main</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;arg1&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;arg2&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arg3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Argument</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./main.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Argument</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arg1.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Argument</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arg2.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Argument</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arg3.</span></span></code></pre></div><p>程序运行正确。接下来用 strace 查看系统调用情况：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> strace</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./main</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;arg1&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;arg2&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arg3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">execve(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">&quot;./main&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./main&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;arg1&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;arg2&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;arg3&quot;],</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0x7fd6828c78</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 32</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vars</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brk(NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                               = 0x558ddaf000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">faccessat(AT_FDCWD,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ld.so.nohwcap&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> F_OK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = -1 ENOENT (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">No</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> such</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">faccessat(AT_FDCWD,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ld.so.preload&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> R_OK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = -1 ENOENT (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">No</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> such</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openat(AT_FDCWD,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ld.so.cache&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> O_RDONLY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">O_CLOEXEC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 3</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fstat(3,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {st_mode=S_IFREG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0644,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> st_size=89739,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mmap(NULL,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 89739,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PROT_READ,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MAP_PRIVATE,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0x7f81dba000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">close(3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                                = 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">faccessat(AT_FDCWD,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/ld.so.nohwcap&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> F_OK</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = -1 ENOENT (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">No</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> such</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> or</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">openat(AT_FDCWD,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/lib/aarch64-linux-gnu/libc.so.6&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> O_RDONLY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">O_CLOEXEC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 3</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">read</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">3,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;\177ELF\2\1\1\3\0\0\0\0\0\0\0\0\3\0\267\0\1\0\0\0 \10\2\0\0\0\0\0&quot;...,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 832</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 832</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fstat(3,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {st_mode=S_IFREG</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0755,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> st_size=1341080,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mmap(NULL,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 8192,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PROT_READ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PROT_WRITE,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MAP_PRIVATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAP_ANONYMOUS,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -1,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0x7f81df8000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mmap(NULL,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1409880,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PROT_READ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PROT_EXEC,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MAP_PRIVATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAP_DENYWRITE,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0x7f81c61000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mprotect(0x7f81da1000,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 61440,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PROT_NONE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mmap(0x7f81db0000,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 24576,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PROT_READ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PROT_WRITE,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MAP_PRIVATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAP_FIXED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAP_DENYWRITE,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0x13f000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0x7f81db0000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mmap(0x7f81db6000,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 13144,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PROT_READ</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PROT_WRITE,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> MAP_PRIVATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAP_FIXED</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MAP_ANONYMOUS,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -1,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0x7f81db6000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">close(3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                                = 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mprotect(0x7f81db0000,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 16384,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PROT_READ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mprotect(0x5585a3f000,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 4096,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PROT_READ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mprotect(0x7f81dfc000,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 4096,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> PROT_READ</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">munmap(0x7f81dba000,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 89739</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)             = 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fstat(1,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {st_mode=S_IFCHR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">0620,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> st_rdev=makedev</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">136,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ...}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brk(NULL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                               = 0x558ddaf000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">brk(0x558ddd0000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                       = 0x558ddd0000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">write(1,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Argument 0 is ./main.\n&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 22Argument</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./main.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) = 22</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">write(1,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Argument 1 is arg1.\n&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 20Argument</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arg1.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)   = 20</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">write(1,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Argument 2 is arg2.\n&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 20Argument</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arg2.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)   = 20</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">write(1,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Argument 3 is arg3.\n&quot;,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 20Argument</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> is</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> arg3.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)   = 20</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">exit_group(0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)                           = </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">+++</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exited</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +++</span></span></code></pre></div><p>运行程序，系统将会从 <code>mian()</code> 函数开始执行，执行系统调用 <code>execve()</code> 函数为程序开辟新的进程。执行 <code>execve()</code> 函数的时候，系统将执行 <code>./main</code> 命令中的所有参数以字符串指针的方式传递给了 <code>execve()</code> 。执行参数包含可执行文件自身，所以我们可以看到 argv 的长度为 4。</p><p>了解系统调用 <code>execve()</code> 函数可以查看<a href="./../gcc 的编译过程/">这篇</a>了解</p></div></div></div><div data-v-872e3c31></div><div class="footer" data-v-872e3c31 data-v-7d1942f1><p data-v-7d1942f1> © 2017 ~ 2025 • Yangholmes </p><p class="driver" data-v-7d1942f1> 使用 ❤️ <a href="https://vitepress.dev/" target="_blank" data-v-7d1942f1>Vitepress</a> 搭建 - Yangholmes 提供主题 </p></div></div></main></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"DohC4ohT\",\"技术的小记_atom 改装指南_index.md\":\"Ca9YaAXR\",\"技术的小记_extjs 自定义 datetimefield 控件_index.md\":\"H2lYWth3\",\"技术的小记_index.md\":\"CSlGSuZA\",\"技术的小记_web 应用榨干 cpu 性能的正确姿势_index.md\":\"HL_SbCAf\",\"技术的小记_什么是原型链_index.md\":\"BS5Kg0ov\",\"技术的小记_如何为 vue 组件提供 slots 静态类型检查_index.md\":\"C0C5qJda\",\"技术的小记_如何在 web 应用中使用 gdal （一）_index.md\":\"Dw16eHej\",\"技术的小记_如何设计一个 brainfuck 解释器_index.md\":\"nkKweMWN\",\"技术的小记_如何设计一个易用的tag组件_index.md\":\"Dr00D504\",\"技术的小记_脚本化css_index.md\":\"CWd0wf2i\",\"派的玩耍小记_c 的 main 函数_index.md\":\"CxFTzX28\",\"派的玩耍小记_gcc 的编译过程_index.md\":\"DU58Grpo\",\"派的玩耍小记_index.md\":\"BGugN51m\",\"派的玩耍小记_orangepi lite 2 刷 ubuntu 18.04.4 方法_index.md\":\"DM8EWnPW\",\"派的玩耍小记_新到的玩具_index.md\":\"Bns2quAD\",\"派的玩耍小记_驱动步进电机_index.md\":\"BOLIAnqb\",\"生活咏叹调_index.md\":\"C78sy8h4\",\"生活咏叹调_我想居然想变老_index.md\":\"ByCcKrzG\",\"生活咏叹调_生命_index.md\":\"BWLIbzZu\",\"生活咏叹调_顽强的绿萝_index.md\":\"bfC-tqu9\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-cn\",\"dir\":\"ltr\",\"title\":\"Yangholmes' blog\",\"description\":\"blog\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"categories\":[\"技术的小记\",\"派的玩耍小记\",\"生活咏叹调\"],\"posts\":{\"技术的小记\":[{\"title\":\"如何在 web 应用中使用 GDAL （一）\",\"category\":\"技术的小记\",\"url\":\"/技术的小记/如何在 web 应用中使用 GDAL （一）\",\"createDate\":\"2025/08/04\",\"excerpt\":\"\"},{\"title\":\"如何为 Vue 组件提供 slots 静态类型检查\",\"category\":\"技术的小记\",\"url\":\"/技术的小记/如何为 Vue 组件提供 slots 静态类型检查\",\"createDate\":\"2025/05/28\",\"excerpt\":\"\"},{\"title\":\"web 应用榨干 CPU 性能的正确姿势\",\"category\":\"技术的小记\",\"url\":\"/技术的小记/web 应用榨干 CPU 性能的正确姿势\",\"createDate\":\"2021/09/03\",\"excerpt\":\"\"},{\"title\":\"什么是原型链\",\"category\":\"技术的小记\",\"url\":\"/技术的小记/什么是原型链\",\"createDate\":\"2021/01/13\",\"excerpt\":\"\"},{\"title\":\"Atom 改装指南\",\"category\":\"技术的小记\",\"url\":\"/技术的小记/Atom 改装指南\",\"createDate\":\"2018/06/22\",\"excerpt\":\"\"},{\"title\":\"如何设计一个 BrainFuck 解释器\",\"category\":\"技术的小记\",\"url\":\"/技术的小记/如何设计一个 BrainFuck 解释器\",\"createDate\":1526860800000,\"excerpt\":\"\"},{\"title\":\"如何设计一个易用的tag组件\",\"category\":\"技术的小记\",\"url\":\"/技术的小记/如何设计一个易用的tag组件\",\"createDate\":1526342400000,\"excerpt\":\"\"},{\"title\":\"脚本化CSS\",\"category\":\"技术的小记\",\"url\":\"/技术的小记/脚本化CSS\",\"createDate\":\"2016/05/09\",\"excerpt\":\"\"},{\"title\":\"ExtJS 自定义 datetimefield 控件\",\"category\":\"技术的小记\",\"url\":\"/技术的小记/ExtJS 自定义 datetimefield 控件\",\"createDate\":\"2016/05/07\",\"excerpt\":\"\"}],\"派的玩耍小记\":[{\"title\":\"OrangePi Lite 2 刷 Ubuntu 18.04.4 方法\",\"category\":\"派的玩耍小记\",\"url\":\"/派的玩耍小记/OrangePi Lite 2 刷 Ubuntu 18.04.4 方法\",\"createDate\":\"2020/05/03\",\"excerpt\":\"\"},{\"title\":\"驱动步进电机\",\"category\":\"派的玩耍小记\",\"url\":\"/派的玩耍小记/驱动步进电机\",\"createDate\":\"2019/11/23\",\"excerpt\":\"\"},{\"title\":\"C 的 main 函数\",\"category\":\"派的玩耍小记\",\"url\":\"/派的玩耍小记/C 的 main 函数\",\"createDate\":\"2019/10/27\",\"excerpt\":\"\"},{\"title\":\"gcc 的编译过程\",\"category\":\"派的玩耍小记\",\"url\":\"/派的玩耍小记/gcc 的编译过程\",\"createDate\":\"2019/10/27\",\"excerpt\":\"\"},{\"title\":\"新到的玩具\",\"category\":\"派的玩耍小记\",\"url\":\"/派的玩耍小记/新到的玩具\",\"createDate\":1572019200000,\"excerpt\":\"\"}],\"生活咏叹调\":[{\"title\":\"顽强的绿萝\",\"category\":\"生活咏叹调\",\"url\":\"/生活咏叹调/顽强的绿萝\",\"createDate\":\"2020/11/19\",\"excerpt\":\"\"},{\"title\":\"生命\",\"category\":\"生活咏叹调\",\"url\":\"/生活咏叹调/生命\",\"createDate\":\"2020/11/18\",\"excerpt\":\"\"},{\"title\":\"我想居然想变老\",\"category\":\"生活咏叹调\",\"url\":\"/生活咏叹调/我想居然想变老\",\"createDate\":\"2020/11/17\",\"excerpt\":\"\"}]},\"lastUpdated\":true,\"search\":{\"provider\":\"local\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/Yangholmes\"},{\"icon\":\"dev\",\"link\":\"https://dev.to/yangholmes\"},{\"icon\":\"instagram\",\"link\":\"https://www.instagram.com/yangholmes/\"},{\"icon\":\"wechat\",\"link\":\"/wechat-qrcode.png\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  <script type="text/javascript">
          (function(c,l,a,r,i,t,y){
              c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
              t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
              y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
          })(window, document, "clarity", "script", "sqwvxx7phf");
        </script></body>
</html>