import{d as v,u as b,f as g,r as n,w as y,g as h,c as t,B as S,S as c,a as u,b as D}from"./index-DKfBTmuW.js";import{u as F}from"./useTRouter-uLkOWfVT.js";import{B as I,s as C}from"./index-DvACruHp.js";import{a as w,B as A}from"./BasicTopBar-LMa3HoZJ.js";import{D as E}from"./DeleteConfirmButton-Dk5e735Y.js";import{s as q}from"./utils-BQrkF7YI.js";import"./vue-utils-DDT1N9zk.js";import"./InputGroup-BhRp2sTJ.js";import"./Popover-DeIHNoZk.js";import"./get-An1JkWno.js";import"./create-D3Vn69pI.js";import"./FormItem-D0BSVghb.js";import"./Image-D_x-ppiA.js";import"./InputNumber-DaeUUB-u.js";import"./Popconfirm-Cv-jwyyR.js";const N={"edit-book":"_edit-book_166qk_1"},K=v({name:"EditBook",setup(){const{t:i}=b({useScope:"global"}),{route:m,router:d}=F(),{message:r}=g(),l=n(),s=n(),a=n(!1),p=o=>{a.value=!0,u.book.queryBookByBookId(o).then(e=>{e&&(s.value=e)}).finally(()=>{a.value=!1})};function f(o){return a.value=!0,(o?Promise.resolve(o):Promise.reject()).then(e=>C(e)).catch(e=>{throw r.error(...q(o)),e}).finally(()=>{a.value=!1})}y(()=>m.params.bookId,o=>{Array.isArray(o)||p(o)},{immediate:!0});function k(){var o;(o=l.value)==null||o.getFormData().then(e=>{const B=e;u.book.updateBook(B).then(()=>{r.success(i("pages.book.edit.saveSuccess"))})})}return h(()=>{r.destroyAll()}),()=>t("div",{class:D(N["edit-book"])},[t(w,{topBar:t(A,{rightSlots:[t(S,{onClick:k},{default:()=>[t(c,{name:"save"},null)]}),t(E,{onConfirm:()=>{var e;const o=(e=s.value)==null?void 0:e.id;o&&u.book.deleteBook(o).then(()=>{r.success(i("pages.book.edit.deleteSuccess")),d.back()})}},{default:()=>[t(c,{name:"delete"},null)]})]},{default:()=>{var o;return[((o=s.value)==null?void 0:o.title)||"-"]}})},{default:()=>[t(I,{ref:l,scraping:a.value,data:s.value,onScrape:f},null)]})])}});export{K as default};
//# sourceMappingURL=EditBook-BZVMt_tN.js.map
